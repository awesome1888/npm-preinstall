#!/usr/bin/env node
module.exports=function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=10)}([function(e,n){e.exports=require("path")},function(e,n){e.exports=require("fs")},function(e,n){e.exports=require("debug")},function(e,n){e.exports=require("child_process")},function(e,n){e.exports=require("fs-equal")},function(e,n){e.exports=require("fs-copy-file-sync")},function(e,n){e.exports=require("copy-dir")},function(e,n){e.exports=require("glob")},function(e,n){e.exports=require("lodash.get")},function(e,n){e.exports=require("@babel/polyfill")},function(e,n,r){"use strict";r.r(n);r(9);var t=r(1),o=r.n(t),i=r(0),c=r.n(i),s=r(2),u=r.n(s),a=r(3),f=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=n||[];var t=r.stdoutTo||process.stdout,o=r.stderrTo||process.stderr,i=r.cwd||process.cwd;return new Promise(function(r){var c=Object(a.spawn)(e,n,{cwd:i,stdio:"inherit",shell:!0});t&&c.stdout&&c.stdout.pipe(t),o&&c.stderr&&c.stderr.pipe(o),c.on("error",function(){r(1)}),c.on("close",function(e){r(e)}),c.on("exit",function(e){r(e)})})},p=r(4),l=r(5),d=r.n(l),x=r(6),v=r.n(x),g=r(7),b=r.n(g),h=r(8),m=r.n(h);function y(e,n,r,t,o,i,c){try{var s=e[i](c),u=s.value}catch(e){return void r(e)}s.done?n(u):Promise.resolve(u).then(t,o)}function k(e){return function(){var n=this,r=arguments;return new Promise(function(t,o){var i=e.apply(n,r);function c(e){y(i,t,o,c,s,"next",e)}function s(e){y(i,t,o,c,s,"throw",e)}c(void 0)})}}var w=function(){var e=k(regeneratorRuntime.mark(function e(n){var r,t,i,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.a.join(n,"package.json"),t=c.a.join(n,"node_modules/.packagejson.lock"),!o.a.existsSync(r)){e.next=23;break}return i=!1,e.prev=4,e.next=7,Object(p.areFilesEqual)(r,t);case 7:i=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:if(i){e.next=23;break}return console.log('>>> Re-installing packages in "'.concat(n,'"')),e.next=16,f("npm",["install"],{cwd:n});case 16:if(d()(r,t),s=c.a.join(n,".node_modules_patches"),u=c.a.join(n,"node_modules"),!o.a.existsSync(s)){e.next=23;break}return console.log(">>>>>> Applying node_modules monkey-patch ðŸ™ˆ"),e.next=23,new Promise(function(e,n){v()(s,u,function(r){r?n(r):e()})});case 23:case"end":return e.stop()}},e,this,[[4,10]])}));return function(n){return e.apply(this,arguments)}}(),j=function(){var e=k(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){b()(n,{cwd:r},function(n,r){n?t(n):e(r)})}));case 1:case"end":return e.stop()}},e,this)}));return function(n,r){return e.apply(this,arguments)}}();k(regeneratorRuntime.mark(function e(){var n,r,t,i,s,a,p,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u()("main"),r=process.cwd(),process.argv.shift(),process.argv.shift(),t=process.argv.shift(),i=c.a.join(r,"package.json"),"--monorepo"!==t){e.next=27;break}if(!o.a.existsSync(i)){e.next=25;break}s=null;try{s=JSON.parse(o.a.readFileSync(i))}catch(e){}if(a=null,s&&(a=m()(s,"workspaces.packages.0")),!a){e.next=25;break}return e.next=15,j(a,r);case 15:if(!(p=e.sent)||!p.length){e.next=25;break}l=0;case 18:if(!(l<p.length)){e.next=25;break}return d=p[l],e.next=22,w(c.a.join(r,d));case 22:l++,e.next=18;break;case 25:e.next=34;break;case 27:return e.next=29,w(r);case 29:if(n(process.argv.join(" ")),!t||!t.length){e.next=34;break}return u()("Executing ".concat(t)),e.next=34,f(t,process.argv);case 34:n("Done");case 35:case"end":return e.stop()}},e,this)}))()}]);